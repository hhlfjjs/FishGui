<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=gb2312">
<title>FishGUI: MyButton.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- 制作者 Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="main.html">首页</a> | <a class="qindex" href="modules.html">模块</a> | <a class="qindex" href="hierarchy.html">类继承关系</a> | <a class="qindex" href="classes.html">按字典顺序排序的列表</a> | <a class="qindex" href="annotated.html">组合类型列表</a> | <a class="qindex" href="files.html">文件列表</a> | <a class="qindex" href="functions.html">组合类型成员</a> | <a class="qindex" href="globals.html">文件成员</a></div>
<h1>MyButton.cpp</h1><a href="MyButton_8cpp.html">浏览该文件的文档。</a><div class="fragment"><pre>00001 <span class="comment">/*--------------------------------------------------------------------------</span>
00002 <span class="comment"></span>
00003 <span class="comment">        MyButton.cpp - 用户定义的圆角矩形类的实现文件</span>
00004 <span class="comment"></span>
00005 <span class="comment">        本程序是FishGUI软件的一部分</span>
00006 <span class="comment"></span>
00007 <span class="comment">        版权所有 (C) 2003,2004 王咏武</span>
00008 <span class="comment">        http://www.contextfree.net/wangyw/</span>
00009 <span class="comment"></span>
00010 <span class="comment">----------------------------------------------------------------------------</span>
00011 <span class="comment"></span>
00012 <span class="comment">        作者对 FishGUI 软件及其所有源代码授权如下：</span>
00013 <span class="comment"></span>
00014 <span class="comment">        允许任何个人、组织、机构、企业无偿获得、修改、使用、重新发布 FishGUI 软</span>
00015 <span class="comment">        件及其源代码，或按照有偿或者无偿的方式发行基于 FishGUI 源代码的全部或部</span>
00016 <span class="comment">        分内容开发的软件产品，――但行使以上权利时，须遵守以下约定：</span>
00017 <span class="comment"></span>
00018 <span class="comment">        1、重新发布 FishGUI 软件及其源代码时，不得隐去软件及其源代码中原有的版</span>
00019 <span class="comment">           权信息和开发者标识。</span>
00020 <span class="comment"></span>
00021 <span class="comment">        2、发行基于 FishGUI 源代码的全部或部分内容开发的软件产品时，必须在产品</span>
00022 <span class="comment">           的显著位置标明以下字样：</span>
00023 <span class="comment"></span>
00024 <span class="comment">           【本产品的一部分功能是基于王咏武在 FishGUI 软件中的工作完成的】</span>
00025 <span class="comment"></span>
00026 <span class="comment">        3、在正式出版物中引用 FishGUI 的文档、源代码或注释内容的，应注明软件的</span>
00027 <span class="comment">           原作者为王咏武。</span>
00028 <span class="comment"></span>
00029 <span class="comment">--------------------------------------------------------------------------*/</span>
00040 <span class="preprocessor">#include "<a class="code" href="MyButton_8h.html">MyButton.h</a>"</span>
00041 
<a name="l00042"></a><a class="code" href="classMyButton.html#b1">00042</a> <a class="code" href="group__MsgMap__Define.html#ga1">BEGIN_MESSAGE_MAP</a>(<a class="code" href="classMyButton.html">MyButton</a>, <a class="code" href="classFG__Button.html">FG_Button</a>)
00043     <a class="code" href="group__MsgMap__Define.html#ga2">ON_DRAW</a>         (MyButton::OnDraw)
00044 <a class="code" href="group__MsgMap__Define.html#ga15">END_MESSAGE_MAP</a>()
00045 
00046 <span class="comment">//##ModelId=3F71AB03038F</span>
<a name="l00047"></a><a class="code" href="classMyButton.html#b0">00047</a> <span class="keywordtype">void</span> <a class="code" href="classMyButton.html#b0">MyButton::OnDraw</a>(<a class="code" href="classFG__OSAdaptor.html">FG_OSAdaptor</a> * pAdaptor)
00048 {
00049     pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a3">BeginDraw</a>(m_Rect);
00050     
00051         <a class="code" href="structFG__Point.html">FG_Point</a> p[6];
00052     <a class="code" href="structFG__Rect.html">FG_Rect</a> Rect;
00053     <span class="keywordflow">switch</span>(m_wStyle &amp; <a class="code" href="group__Frame__Style.html#ga4">FS_MASK</a>)
00054     {
00055     <span class="keywordflow">case</span>  <a class="code" href="group__Frame__Style.html#ga2">FS_RAISED</a>:
00056         Rect = m_Rect;
00057         pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a5">FillRect</a>(Rect, m_Background, m_Background);
00058 
00059                 p[0].<a class="code" href="structFG__Point.html#o0">x</a> = p[1].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft;
00060                 p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 4;
00061                 p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 3;
00062         p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 3;
00063                 p[2].<a class="code" href="structFG__Point.html#o1">y</a> = p[3].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop;
00064                 p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 3;
00065                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(4, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a1">COLOR_GRAY</a>);
00066 
00067         <span class="comment">// 画高亮区</span>
00068                 p[0].<a class="code" href="structFG__Point.html#o0">x</a> = p[1].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 1;
00069                 p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 5;
00070         p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 4;
00071         p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 4;
00072                 p[2].<a class="code" href="structFG__Point.html#o1">y</a> = p[3].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 1;
00073                 p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 4;
00074                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(4, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a2">COLOR_WHITE</a>);
00075 
00076         <span class="comment">// 画黑边框</span>
00077         p[0].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 4;
00078         p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 1;
00079         p[1].<a class="code" href="structFG__Point.html#o0">x</a> = p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 1;
00080         p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 4;
00081         p[2].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 4;
00082         p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 4;
00083         p[3].<a class="code" href="structFG__Point.html#o1">y</a> = p[4].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 1;
00084         p[4].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 4;
00085         p[5].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 1;
00086         p[5].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 4;
00087         pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(6, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a3">COLOR_DARKGRAY</a>);
00088 
00089         <span class="comment">// 画阴影</span>
00090         p[0].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 3;
00091         p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop;
00092                 p[1].<a class="code" href="structFG__Point.html#o0">x</a> = p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight;
00093                 p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 3;
00094         p[2].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 3;
00095         p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 3;
00096                 p[3].<a class="code" href="structFG__Point.html#o1">y</a> = p[4].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom;
00097                 p[4].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 3;
00098         p[5].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft;
00099         p[5].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 3;
00100                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(6, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a0">COLOR_BLACK</a>);
00101         <span class="keywordflow">break</span>;
00102 
00103     <span class="keywordflow">case</span> <a class="code" href="group__Frame__Style.html#ga3">FS_RECESSED</a>:
00104         Rect = m_Rect;
00105         pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a5">FillRect</a>(Rect, m_Background, m_Background);
00106 
00107                 p[0].<a class="code" href="structFG__Point.html#o0">x</a> = p[1].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 1;
00108                 p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 4;
00109         p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 4;
00110         p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 4;
00111                 p[2].<a class="code" href="structFG__Point.html#o1">y</a> = p[3].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 1;
00112                 p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 4;
00113                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(4, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a1">COLOR_GRAY</a>);
00114 
00115         <span class="comment">// 画高亮区</span>
00116                 p[0].<a class="code" href="structFG__Point.html#o0">x</a> = p[1].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight;
00117                 p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 3;
00118         p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 3;
00119         p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 3;
00120                 p[2].<a class="code" href="structFG__Point.html#o1">y</a> = p[3].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom;
00121                 p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 3;
00122                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(4, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a2">COLOR_WHITE</a>);
00123 
00124         <span class="comment">// 画黑边框</span>
00125         p[0].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 3;
00126         p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom;
00127                 p[1].<a class="code" href="structFG__Point.html#o0">x</a> = p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft;
00128                 p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 3;
00129         p[2].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 3;
00130         p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 3;
00131                 p[3].<a class="code" href="structFG__Point.html#o1">y</a> = p[4].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop;
00132                 p[4].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 3;
00133         p[5].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight;
00134         p[5].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 3;
00135                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(6, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a3">COLOR_DARKGRAY</a>);
00136 
00137         <span class="comment">// 画阴影</span>
00138         p[0].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 4;
00139         p[0].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 1;
00140                 p[1].<a class="code" href="structFG__Point.html#o0">x</a> = p[2].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 1;
00141                 p[1].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wBottom - 4;
00142         p[2].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 4;
00143         p[3].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wLeft + 4;
00144                 p[3].<a class="code" href="structFG__Point.html#o1">y</a> = p[4].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 1;
00145                 p[4].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 4;
00146         p[5].<a class="code" href="structFG__Point.html#o0">x</a> = m_Rect.wRight - 1;
00147         p[5].<a class="code" href="structFG__Point.html#o1">y</a> = m_Rect.wTop + 4;
00148                 pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a11">DrawPolyLine</a>(6, p, <a class="code" href="FG__X11Adaptor_8cpp.html#a0">COLOR_BLACK</a>);
00149         <span class="keywordflow">break</span>;
00150 
00151     <span class="keywordflow">default</span>:
00152         <span class="keywordflow">break</span>;
00153     }
00154 
00155     <span class="keywordflow">if</span> (<a class="code" href="classFG__TextWidget.html#a3">TextLength</a>())
00156     {
00157         <span class="comment">// 写按钮文字</span>
00158         <a class="code" href="group__Utility.html#ga1">WORD</a> x = m_Rect.<a class="code" href="structFG__Rect.html#o0">wLeft</a> + (m_Rect.<a class="code" href="structFG__Rect.html#o2">wRight</a> - m_Rect.<a class="code" href="structFG__Rect.html#o0">wLeft</a> + 1 - pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a8">GetTextWidth</a>(<a class="code" href="classFG__TextWidget.html#a1">GetText</a>())) / 2;
00159         <a class="code" href="group__Utility.html#ga1">WORD</a> y = m_Rect.<a class="code" href="structFG__Rect.html#o1">wTop</a> + (m_Rect.<a class="code" href="structFG__Rect.html#o3">wBottom</a> - m_Rect.<a class="code" href="structFG__Rect.html#o1">wTop</a> + 1 - pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a9">GetTextHeight</a>(<a class="code" href="classFG__TextWidget.html#a1">GetText</a>())) / 2;
00160         pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a7">DrawText</a>(<a class="code" href="classFG__TextWidget.html#a1">GetText</a>(), x, y, m_ForeColor);
00161         <span class="keywordflow">if</span> (<a class="code" href="classFG__Object.html#a19">IsFocus</a>())
00162         {
00163             <a class="code" href="structFG__Rect.html">FG_Rect</a> rect;
00164             <a class="code" href="classFG__Object.html#a3">GetClientRect</a>(rect);
00165             rect -= 1;
00166             pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a12">DrawDotRect</a>(rect, <a class="code" href="FG__X11Adaptor_8cpp.html#a0">COLOR_BLACK</a>);
00167         }
00168     }
00169 
00170     pAdaptor-&gt;<a class="code" href="classFG__OSAdaptor.html#a4">EndDraw</a>();
00171 }
00172 
</pre></div><hr><center>由 DoxyGen 1.3.6 于 Wed Jun 9 22:34:42 2004 生成<br>版权所有 (C) 2003,2004 王咏武</body></html>
